<!DOCTYPE html>
<html lang="ja" id="top">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>クラブ＆バー</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: url('bg.png');
      color: #fff;
      font-family: "Noto Serif JP", "Playfair Display", serif;
      overflow-x: hidden;
    }
    .top-logo { position: relative; margin: 0 0 0 4.3%; width: 20.3%; z-index: 100; transition: opacity .3s ease; }
    .hamburger-container { position: fixed; top: 0; right: 0; width: 71px; height: 71px; cursor: pointer; z-index: 10001; }
    .hamburger-container .line1, .hamburger-container .line2 {
      position: absolute; left: calc((71px - 42px) / 2); width: 42px; height: 1px; background: #fff; transition: .3s ease;
    }
    .hamburger-container .line1 { top: 23px; }
    .hamburger-container .line2 { top: 37px; }
    .hamburger-container .menu-text { position: absolute; bottom: 7px; left: calc((71px - 42px)/2); width: 42px; text-align: center; font-size: 11px; letter-spacing: .1em; margin: 0; padding: 0; color: #fff; }
    .hamburger-container .close-label { display: none; }
    .hamburger-container.open .line1 { top: 35px; transform: rotate(45deg); background: #90a1a6; }
    .hamburger-container.open .line2 { top: 35px; transform: rotate(-45deg); background: #90a1a6; }
    .hamburger-container.open .menu-label { display: none; }
    .hamburger-container.open .close-label { display: inline; color: #90a1a6; }
    #menu { position: fixed; inset: 0; display: none; background: rgba(0,0,0,.95); z-index: 10000; flex-direction: column; align-items: center; justify-content: center; }
    #menu a { color: #fff; font-size: 2rem; margin: 15px 0; text-decoration: none; }
    #top.open .top-logo { opacity: 0; }
    .scroll-container { position: relative; width: 100%; height: 61dvh; overflow: hidden; z-index: 50; }
    .scroll-track { display: flex; animation: scroll-left 60s linear infinite; }
    .scroll-item { flex-shrink: 0; margin-right: 10px; }
    .scroll-item img { height: 61dvh; width: auto; display: block; }
    @keyframes scroll-left { 0% { transform: translateX(0) } 100% { transform: translateX(-1800px) } }
    .firstview-text { position: absolute; left: 4.3vw; bottom: 0; font-size: 10px; line-height: 1.5; color: #7f7f7f; margin: 0; padding: 0; }
    .ticket-box { position: absolute; width: 26vw; height: 23vw; background: rgba(0,0,0,.6); border: 1px solid #555; border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box; padding: 1rem; text-align: center; }
    .ticket-box h3 { margin: 0; font-size: clamp(1rem,2.5vw,1.5rem); color: #ccc; }
    .ticket-box .ticket-num { margin: .5rem 0 0; font-size: clamp(2rem,5vw,4rem); font-weight: bold; color: #fff; text-shadow: 0 0 5px rgba(0,0,0,.7);}
    #ticket-casino{left:5vw;bottom:5vw;}
    #ticket-darts{left:37vw;bottom:5vw;}
    #ticket-mahjong{left:69vw;bottom:5vw;}
    .info-number { position: absolute; bottom: 28vw; width: 100%; text-align: center; font-size: clamp(1.2rem,3vw,2rem); color: #fff; }
    .a-container {
      position: absolute;
      top: 105dvh;
      left: 2vw;
      width: 96vw;
      height: 50dvh;
      box-sizing: border-box;
      z-index: 65;
      pointer-events: none;
    }
    .a-container img.ugokuA,
    .a-container img.ugokuB {
      opacity: 0;
      transform: translateY(0);
      transition: opacity 0.5s cubic-bezier(.35,.87,.55,1.05), transform 0.5s cubic-bezier(.35,.87,.55,1.05);
    }
    .a-container.show img.ugokuA,
    .a-container.show img.ugokuB {
      opacity: 1;
      transform: translateY(20px);
    }
    .a-container img.ugokuA {
      position: absolute;
      top: 30px;
      left: 0;
      width: 42vw;
      height: auto;
    }
    .a-container img.ugokuB {
      position: absolute;
      bottom: 0;
      right: 0;
      width: 35vw;
      height: auto;
    }
    #slider-section {
      position: relative;
      height: 400vh;
      z-index: 10;
      margin-top: 165dvh;
    }
    #slider-sticky {
      position: sticky;
      top: 0;
      height: 100vh;
      display: flex;
      align-items: center;
      overflow: hidden;
      background: transparent;
      z-index: 20;
    }
    #slider-track {
      display: flex;
      align-items: center;
      height: 70vh;
      will-change: transform;
      transition: none;
    }
    #slider-track img {
      width: 94vw;
      height: auto;
      object-fit: contain;
      flex-shrink: 0;
      user-select: none;
      pointer-events: none;
      margin-right: 4vw;
      margin-left: 0;
    }
    #slider-track img:first-child {
      margin-left: 3vw;
    }
    #slider-track img:last-child {
      margin-right: 0;
    }
    .about-section { position: absolute; top: 155dvh; left: 0; width: 100%; padding: 6vw 5vw 8vw; background: url('bg.png') center/cover no-repeat; box-sizing: border-box; z-index: 70;}
    .about-inner{max-width:900px;margin:0 auto;text-align:center;padding-top:20px;}
    .about-en,.about-lead{transition:transform .5s ease;}
    .about-section.show .about-en, .about-section.show .about-lead{transform:translateY(-20px);}
    .about-desc{transition:transform .5s ease .3s;}
    .about-section.show .about-desc{transform:translateY(-20px);}
    .about-en{font-family:"Playfair Display",serif;font-size:clamp(20px,4vw,34px);letter-spacing:.25em;text-transform:uppercase;color:#90a1a6;margin:0 0 1.5rem;font-weight:200;line-height:1;}
    .about-lead{font-size:clamp(22px,4.5vw,36px);line-height:1.4;font-weight:600;margin:0 0 2rem;color:#fff;}
    .about-desc{font-size:clamp(15px,3.2vw,20px);line-height:1.9;margin:0;color:#fff;}
    .sp-only{display:none;}@media(max-width:768px){.sp-only{display:inline;}}
    .logo{position:absolute;width:29.3vw;height:25.784vw;left:35.35vw;top:calc(217.5px + 6.206vw);background:url('logoB.png') no-repeat center/cover;z-index:9999;}
    footer {
      background: url('bg.png');
      color: #fff;
      text-align: center;
      padding: 30px 0 12px 0;
      font-size: 15px;
      border-top: 1px solid #363636;
      letter-spacing: 0.03em;
    }
    .footer-powered {
      font-size: 10px;
      color: #aaa;
      margin-top: 14px;
      margin-bottom: 0;
      letter-spacing: 0.05em;
    }
    /* ======= モーダル(ACCESS) ======= */
    .modal-overlay {
      display: none;
      position: fixed;
      z-index: 20000;
      inset: 0;
      background: rgba(0,0,0,0.85);
      align-items: center;
      justify-content: center;
    }
    .modal-overlay.show {
      display: flex;
    }
    .modal-content {
      position: relative;
      max-width: 95vw;
      max-height: 95vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-content img {
      max-width: 90vw;
      max-height: 80vh;
      border-radius: 8px;
      box-shadow: 0 2px 24px rgba(0,0,0,0.8);
      background: #fff;
      display: block;
    }
    .modal-close {
      position: absolute;
      top: -25px;
      right: -15px;
      font-size: 38px;
      color: #fff;
      background: rgba(0,0,0,0.2);
      border: none;
      border-radius: 50%;
      width: 38px;
      height: 38px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
      transition: background 0.2s;
    }
    .modal-close:hover {
      background: rgba(0,0,0,0.6);
    }
  </style>
</head>
<body id="top">

  <!-- ハンバーガー -->
  <div class="hamburger-container" onclick="toggleMenu()">
    <div class="line1"></div><div class="line2"></div>
    <p class="menu-text"><span class="menu-label">MENU</span><span class="close-label">CLOSE</span></p>
  </div>

  <!-- オーバーレイ -->
  <nav id="menu">
    <a href="#top" onclick="toggleMenu()">TOP</a>
    <a href="#about" onclick="toggleMenu()">ABOUT</a>
    <a href="#whatcan" onclick="toggleMenu()">WHAT CAN YOU DO?</a>
    <a href="#" id="access-link">ACCESS</a>
  </nav>

  <!-- モーダル（ACCESS画像） -->
  <div class="modal-overlay" id="access-modal">
    <div class="modal-content">
      <button class="modal-close" id="access-close" aria-label="閉じる">&times;</button>
      <img src="ACCESS.png" alt="アクセス" />
    </div>
  </div>

  <!-- ロゴA -->
  <img src="logoA.png" alt="Logo A" class="top-logo"/>

  <!-- スクロール画像 -->
  <div class="scroll-container">
    <div class="scroll-track">
      <div class="scroll-item"><img src="scroll1.png" alt="1"></div>
      <div class="scroll-item"><img src="scroll2.png" alt="2"></div>
      <div class="scroll-item"><img src="scroll3.png" alt="3"></div>
      <div class="scroll-item"><img src="scroll4.png" alt="4"></div>
    </div>
    <p class="firstview-text">ネオンが灯る、音と遊びのバー 「Bar KIKAK」<br>4年3組に開店</p>
  </div>

  <!-- 整理券 -->
  <div id="ticket-casino" class="ticket-box"><h3>カジノ</h3><p class="ticket-num">—</p></div>
  <div id="ticket-darts"  class="ticket-box"><h3>ダーツ</h3><p class="ticket-num">—</p></div>
  <div id="ticket-mahjong"class="ticket-box"><h3>麻雀</h3><p class="ticket-num">—</p></div>

  <!-- ご案内番号 -->
  <p class="info-number">ご案内番号</p>

  <!-- Aコンテナ（ugokuA, ugokuB 下にふわっとアニメ） -->
  <div class="a-container">
    <img src="ugokuA.png" alt="動くA" class="ugokuA" />
    <img src="ugokuB.png" alt="動くB" class="ugokuB" />
  </div>

  <!-- バータクト式 横スライダー -->
  <div id="slider-section" class="">
    <div id="slider-sticky">
      <div id="slider-track">
        <img src="yokoA.png" alt="A">
        <img src="yokoB.png" alt="B">
        <img src="yokoC.png" alt="C">
        <img src="yokoD.png" alt="D">
      </div>
    </div>
  </div>

  <!-- フッター -->
  <footer>
    本サイトでは個人情報の入力やCookie等を用いた情報収集は行っておりません
    <div class="footer-powered">powered by ChatGPT</div>
  </footer>

  <!-- ABOUT -->
  <section id="about" class="about-section">
    <div class="about-inner">
      <h2 class="about-en">ABOUT</h2>
      <p class="about-lead">会話、空間、<br class="sp-only">時の流れを愉しむ場所</p>
      <p class="about-desc">4年3組に開店した「Bar KIKAK」。<br>重厚感ある空間で、上質な娯楽と心地よい時間をお届けします。<br>お一人でも、誰かとでも―。<br>どのようなシーンでもご満足いただけるひとときをご提供いたします。</p>
    </div>
  </section>

  <!-- ロゴB -->
  <div class="logo"></div>

  <script>
    function toggleMenu(){
      const body=document.getElementById('top');
      const hamb=document.querySelector('.hamburger-container');
      const menu=document.getElementById('menu');
      const isOpen=hamb.classList.toggle('open');
      body.classList.toggle('open',isOpen);
      menu.style.display=isOpen?'flex':'none';
    }

    document.addEventListener('DOMContentLoaded',()=>{
      // ABOUT
      const about=document.querySelector('.about-section');
      new IntersectionObserver(e=>{
        if(e[0].isIntersecting){about.classList.add('show')}
      },{threshold:.1}).observe(about);

      // Aコンテナ (ugokuA/ugokuB)も同様、1秒遅延でshowクラス付与
      const acont=document.querySelector('.a-container');
      new IntersectionObserver(e=>{
        if(e[0].isIntersecting && !acont.classList.contains('show')){
          setTimeout(()=>acont.classList.add('show'), 1000);
        }
      },{threshold:.1}).observe(acont);

      // ACCESSメニューのクリックでモーダルを表示
      const accessLink = document.getElementById('access-link');
      const accessModal = document.getElementById('access-modal');
      const accessClose = document.getElementById('access-close');
      accessLink.addEventListener('click', function(e) {
        e.preventDefault();
        accessModal.classList.add('show');
        document.body.style.overflow = 'hidden';
      });
      accessClose.addEventListener('click', function() {
        accessModal.classList.remove('show');
        document.body.style.overflow = '';
      });
      // オーバーレイ背景クリックでも閉じる
      accessModal.addEventListener('click', function(e){
        if(e.target === accessModal){
          accessModal.classList.remove('show');
          document.body.style.overflow = '';
        }
      });
    });

    // バータクト式 横スライダー + yokosura解除
    document.addEventListener('DOMContentLoaded', function() {
      const section = document.getElementById('slider-section');
      const track  = document.getElementById('slider-track');
      const sticky = document.getElementById('slider-sticky');
      const numSlides = track.children.length;

      function getSlideWidth() {
        const img = track.children[0];
        const style = window.getComputedStyle(img);
        return img.offsetWidth + parseFloat(style.marginRight);
      }

      function updateSlider() {
        const slideWidth = getSlideWidth();
        const totalScroll = window.innerHeight * (numSlides - 1);

        const sectionTop = section.offsetTop;
        const sectionHeight = section.offsetHeight;
        const scrollY = window.scrollY || window.pageYOffset;
        const min = sectionTop;
        const max = sectionTop + sectionHeight - window.innerHeight;
        const scroll = Math.min(Math.max(scrollY, min), max) - sectionTop;

        const progress = Math.max(0, Math.min(1, scroll / totalScroll));
        const maxTranslate = slideWidth * (numSlides - 1);
        track.style.transform = `translateX(-${progress * maxTranslate}px)`;

        // yokosuraクラスの付与・解除（sticky内のみで制御）
        if (progress < 1) {
          if (!section.classList.contains('yokosura')) section.classList.add('yokosura');
        } else {
          if (section.classList.contains('yokosura')) section.classList.remove('yokosura');
        }
      }

      window.addEventListener('load', updateSlider);
      window.addEventListener('scroll', updateSlider);
      window.addEventListener('resize', updateSlider);
    });
  </script>

  <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig={apiKey:"AIzaSyD61hQI08c8ZiIUs-HiRKLHVl3DeTaFmSA",authDomain:"togensai-92cb8.firebaseapp.com",databaseURL:"https://togensai-92cb8-default-rtdb.firebaseio.com",projectId:"togensai-92cb8",storageBucket:"togensai-92cb8.appspot.com",messagingSenderId:"98670394706",appId:"1:98670394706:web:b9f9ce966cbccf1f61ce8b"};
    firebase.initializeApp(firebaseConfig);
    const db=firebase.database();
    const refs={mahjong:db.ref('tickets/mahjong'),casino:db.ref('tickets/casino'),darts:db.ref('tickets/darts')};
    Object.entries(refs).forEach(([k,r])=>{
      const el=document.querySelector(`#ticket-${k} .ticket-num`);
      r.on('value',s=>{el.textContent=s.val()!==null?s.val():'未発行';});
    });
  </script>
</body>
</html>
